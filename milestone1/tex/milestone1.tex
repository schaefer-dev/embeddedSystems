% exercise sheet with header on every page for math or close subjects
\documentclass[12pt]{article}
\usepackage[utf8]{inputenc}
\usepackage{latexsym}
\usepackage{multicol}
\usepackage{fancyhdr}
\usepackage{amsfonts}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{enumerate}
\usepackage{listings}
\usepackage{graphicx}

% Shortcuts for bb, frak and cal letters
\newcommand{\E}{\mathbb{E}}
\newcommand{\V}{\mathbb{V}}
\renewcommand{\P}{\mathbb{P}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\C}{\mathbb{C}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Pfrak}{\mathfrak{P}}
\newcommand{\Pfrac}{\mathfrak{P}}
\newcommand{\Bfrac}{\mathfrak{P}}
\newcommand{\Bfrak}{\mathfrak{B}}
\newcommand{\Fcal}{\mathcal{F}}
\newcommand{\Ycal}{\mathcal{Y}}
\newcommand{\Bcal}{\mathcal{B}}
\newcommand{\Acal}{\mathcal{A}}

% formating
\topmargin -3.5cm
\textheight 22cm
\textwidth 16.0 cm
\oddsidemargin -0.1cm

% Fancy Header on every Page
\pagestyle{fancy}
\lhead{\textbf{Embedded Systems Milestone 1}}
\rhead{Daniel SchÃ¤fer (2549458)\\ Rafael Dewes (2548365)\\ Kevin M\"uller (2550062)}
\renewcommand{\headrulewidth}{1.2pt}
\setlength{\headheight}{110pt}

\begin{document}
\pagenumbering{gobble}
\lstset{language=C++}

\section*{Pins}

% TODO rewrite the section below entirely, this task should only be related to the Expansion Board Schematic

\subsection*{Scout}

\textbf{TODO}: It might be possible that the ADC is not connected over SPI! In this case the function of I/O Clock and System Clock are switched!\\

\small
\begin{tabular}{| c || p{30mm} | p{30mm} | p{60mm} |}
  \hline
  \textbf{PIN} & FUNCTION & alternate Functions & NOTES\\
  \hline
  \hline
  \hline
  \textbf{PB4} & I/O Clock of ADC & SCK of RF module & Synchronisation Clock of Serial Peripheral Interface (Master Slave Connection/SPI).\\
  \hline
  \textbf{PB0} & MOSI & Adress input of ADC & Master Output, Slave Input lane. The Slave Select lane (PD4/PC5) determines with which of the slaves (either RF module or ADC) the master communicates.\\
  \hline
  \textbf{PD4} & RF module Chip Select & - & The Slave Select Lane PD4 detimines that the communication over the BUS is with the RF module (and not with the ADC).\\
  \hline
  \textbf{PD7} & RF module Chip Enable & - & Chip Enable Activates RX (used as receiver) or TX Mode (used as transmitter)\\
  \hline
  \textbf{PD2} & RF IRQ & - & Maskable interrupt pin. Active low. Confirms either packet arrival when package loaded into RX FIFO (RX mode) or arrival of ACK (acknowledge) packet (TX mode).\\
  \hline
  \textbf{PB1} & ADC system clock & - & Prescaled Clock source, which allows time for a conversion to happen inside the ADC (I/O Clock must remain low for at least 36 system clock cycles to allow conversion to be completed)\\
  \hline
  \textbf{PC5} & ADC Chip Select & - & The Slave Select Lane PC5 detimines that the communication over the BUS is with the ADC (and not with the RF Module).\\
  \hline
  \textbf{PD0} & Dev Port RX & - & ?TODO?\\
  \hline
  \textbf{PD1} & Dev Port TX & - & ?TODO?\\
  \hline
\end{tabular}
\normalsize

\vspace{1cm}

\paragraph{Must not be driven in Combination:}
The only Pins that can not be driven simultaniously are the PINS PD4 and PC5. These PINS are used for the SPI Protocol to select either the ADC and RF module as the "receiver" of a message and only one of the chips can be selected using either PIN PD4 OR Pin PC5.


\subsection*{Collector}
\small
\begin{tabular}{c || p{30mm} | p{30mm} | p{60mm}}
  \hline
  \textbf{PIN} & FUNCTION & alternate Functions & NOTES\\
  \hline
  \textbf{PB0} & This Table & needs & a rework\\
  \hline
\end{tabular}
\normalsize

\section*{Interrupts}

\textit{Which conditions should an interrupt concerning the communication with the expansion board occur?} \\
\textit{Is the interrupt triggered by an external or internal source?} \\

3pi/Scout(ATmega 328): \\
\begin{itemize}
\item Finding a location where the photo sensor readings surpass 200 (external)
\item Check for timer $> 5$ minutes (internal)
\end{itemize}
Zumo/Collector(ATmega 32u4): \\
\begin{itemize}
\item Check if communication by Scout $\neq -1$ (external)
\end{itemize} 

\flushleft
\textit{How does the interrupt service routine handle the interrupt? Which pins are affected?} \\

3pi/Scout(ATmega 328): \\
\begin{itemize}
\item Finding a location: INT0, 0x0002
The interrupt is executed asynchronously 
\item Check for timer: TIMER2 COMPA, 0x000E 
\end{itemize}
Zumo/Collector(ATmega 32u4): \\
\begin{itemize}
\item Check Scout communication: INT0, \$0006
\end{itemize}

\end{document}
